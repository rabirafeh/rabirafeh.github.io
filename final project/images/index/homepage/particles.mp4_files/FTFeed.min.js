var FTFeedParams=function(){this.segmentId;this.feedEndpoint;this.defaultFeedEndpoint;this.productId;this.ftCustomProductIdNodeName;this.ftCustomProductIndex=0;this.stringTrackerEventName;this.customMacros;this.customMacrosFlashVars;this.sendSegments},FTFeed=function(t,u){function l(b,c){var v={withCredentials:a.sendSegments||(-1<b.search(/ftcreds=(1|true)/i)?!0:!1),complete:function(b){void 0!==m[c]&&clearTimeout(m[c]);var d=!1,f;try{f=JSON.parse(b.responseText)}catch(g){d=!0}if(a.feedEndpoint===
c&&void 0===n[c]&&(200!==b.status||d||void 0!==f.error))return a.defaultFeedEndpoint!==a.feedEndpoint&&""!==a.defaultFeedEndpoint?(e=p(a.productId,a.defaultFeedEndpoint),l(e,a.defaultFeedEndpoint)):k("Feed error. Possible 4xx, 5xx, parse error or error field. Run backup logic!",e);if(a.defaultFeedEndpoint===c&&void 0===n[c]&&(200!==b.status||d||void 0!==f.error))return k("Feed error. Possible 4xx, 5xx, parse error or error field. Run backup logic!",e);d=f;b=[];Array.isArray(d)?b=d:b.push(d);void 0!==
a.ftCustomProductIdNodeName&&a.ftCustomProductIndex<b.length&&(d=b[a.ftCustomProductIndex][a.ftCustomProductIdNodeName],void 0!==d?q(d):q("default"));r(b,e)}};m[c]=setTimeout(function(){n[c]=1;if(a.feedEndpoint===c&&a.feedEndpoint!==a.defaultFeedEndpoint&&""!==a.defaultFeedEndpoint)return e=p(a.productId,a.defaultFeedEndpoint),l(e,a.defaultFeedEndpoint);k("Feed response timeout error. Exceeded 3 seconds. Run backup logic.",e)},3E3);FT.ajax(b,v)}function w(a){a=(new RegExp("(?:^|,)"+a+"(\\w+?)(,|$)")).exec(this.myFT.get("ftSegment"));
return null!==a?a[1]:""}function p(b,c){var e=this.myFT.get("serveDom")||this.myFT.get("ftServeDom")||"https://cdn.flashtalking.com",e={"[%PROTOCOL%]":-1<e.indexOf("https://")?"https://":"http://","[%PRODUCT_ID%]":b,"[%SERVE_DOM%]":e,"[%CACHEBUSTER%]":Math.floor(9E9*Math.random()),"[%CACHE_BUSTER%]":Math.floor(9E9*Math.random()),"[%RANDOM%]":Math.floor(9E9*Math.random()),"[%ftLat%]":this.myFT.get("ftLat")||"null","[%LAT%]":this.myFT.get("ftLat")||"null","[%ftLong%]":this.myFT.get("ftLong")||this.myFT.get("ftLng")||
"null","[%LNG%]":this.myFT.get("ftLong")||this.myFT.get("ftLng")||"null","[%ftDMA%]":this.myFT.get("ftDMA")||"null","[%DMA%]":this.myFT.get("ftDMA")||"null","[%ftPostal%]":this.myFT.get("ftPostal")||"null","[%POSTAL%]":this.myFT.get("ftPostal")||"null","[%CITY%]":this.myFT.get("ftGeoCity")||"null","[%STATE%]":this.myFT.get("ftGeoState")||"null","[%COUNTRY%]":this.myFT.get("ftGeoCountry")||"null","[%GUID%]":this.myFT.get("guid")||this.myFT.get("ftGUID")||"null","[%CI_ID%]":this.myFT.get("cID")||"null",
"[%CM_ID%]":this.myFT.get("campaignID")||"null","[%CREATIVE_ID%]":this.myFT.get("creativeID")||"null","[%PLACEMENT_ID%]":this.myFT.get("pID")||this.myFT.get("ftPlacementID")||"null","[%KEYWORD%]":this.myFT.get("ftKeyword")||"null","[%TIMESTAMP%]":this.myFT.get("ftTimestamp")||"null","[%FT_CUSTOM%]":this.myFT.get("ftCustom")||"null","[%CUSTOM%]":this.myFT.get("ftCustom")||"null","[%REQUEST_ORIGIN%]":window.location.host,"[%ORIGIN%]":window.location.host};if(a.customMacros)for(var h=a.customMacros.split(/[\s,]+/),
d=a.customMacrosFlashVars?a.customMacrosFlashVars.split(/[\s,]+/):[],f=0;f<h.length;++f)h[f]&&(e[h[f]]=this.myFT.get(d[f])||"null");for(var g in e)-1<c.indexOf(g)&&(c=c.replace(g,e[g]));return c+=-1<c.lastIndexOf("?")?"&callback=[%CALLBACK%]":"?callback=[%CALLBACK%]"}function q(b){b=encodeURIComponent(b);a.stringTrackerEventName&&this.myFT.tracker(a.stringTrackerEventName,null,b);for(var c in this.myFT.get("clicks")){var e=this.myFT.get("clicks"),h=c,d;d=this.myFT.get("clicks")[c];var f=b,g=/(ft_custom=.*?)(&|$)/i;
d=g.test(d)?d.replace(g,"$1__"+f+"$2"):d.replace(/((http(s|):\/\/servedby.flashtalking.com.+?)(&url=))/,"$2&ft_custom="+f+"&url=");e[h]=d}}this.myFT=t;var a=function(a){void 0===a&&(a=new FTFeedParams);void 0===a.segmentId&&(a.segmentId=this.myFT.instantAds.segmentId);void 0===a.feedEndpoint&&(a.feedEndpoint=this.myFT.instantAds.feedEndpoint);void 0===a.defaultFeedEndpoint&&(a.defaultFeedEndpoint=this.myFT.instantAds.defaultFeedEndpoint);void 0===a.productId&&(a.productId=this.myFT.get("ftSku")||
this.myFT.instantAds.productId||"null");return a}(u),e,r,k,n={},m={};this.getFeed=function(b,c){r=b;k=c;"false"!==a.segmentId.toLowerCase()&&""!==a.segmentId&&-1<this.myFT.get("ftSegment").indexOf(a.segmentId)&&(a.productId=w(a.segmentId));"null"===a.productId&&-1<a.feedEndpoint.indexOf("[%PRODUCT_ID%]")&&(a.feedEndpoint=a.defaultFeedEndpoint);e=p(a.productId,a.feedEndpoint);l(e,a.feedEndpoint)}};